---
import Base from '../layouts/Base.astro';
import { BenchmarkRunner } from '../components/BenchmarkRunner';
import '../styles/benchmark.css';
---

<Base title="Benchmarks - @askturret/grid" description="Live benchmarks for @askturret/grid. Test sorting, filtering, and updates on 100k+ rows in your browser.">
  <main class="min-h-screen">
    <!-- Header -->
    <section class="py-16 px-4 text-center">
      <a href="/" class="inline-flex items-center text-grid-muted hover:text-grid-text mb-8">
        ‚Üê Back to home
      </a>
      <h1 class="text-4xl md:text-5xl font-bold text-grid-text mb-4">
        Benchmarks
      </h1>
      <p class="text-xl text-grid-muted max-w-2xl mx-auto">
        Server-side performance. Client-side simplicity.<br />
        Run real benchmarks in your browser.
      </p>
    </section>

    <!-- Interactive Runner -->
    <section class="py-8 px-4">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-2xl font-bold text-grid-text mb-6 text-center">Run Your Own Test</h2>
        <BenchmarkRunner client:load />
      </div>
    </section>

    <!-- Reference Comparisons -->
    <section class="py-12 px-4">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-2xl font-bold text-grid-text mb-2 text-center">Reference Comparisons</h2>
        <p class="text-grid-muted text-center mb-8">Pre-measured baselines from our test environment</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
          <!-- Sort Latency -->
          <div class="feature-card">
            <h3 class="text-lg font-semibold text-grid-text mb-4">Sort Latency (100k rows)</h3>
            <div class="space-y-4">
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-grid-accent">@askturret/grid (WASM)</span>
                  <span class="text-grid-bid">12ms</span>
                </div>
                <div class="h-2 bg-grid-bg rounded overflow-hidden">
                  <div class="h-full bg-grid-accent rounded" style="width: 6%"></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-grid-muted">Pure JavaScript</span>
                  <span class="text-grid-muted">180ms</span>
                </div>
                <div class="h-2 bg-grid-bg rounded overflow-hidden">
                  <div class="h-full bg-grid-muted rounded" style="width: 90%"></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-grid-muted">Server-side</span>
                  <span class="text-grid-muted">~100ms + network</span>
                </div>
                <div class="h-2 bg-grid-bg rounded overflow-hidden">
                  <div class="h-full bg-grid-muted rounded" style="width: 50%"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Filter Latency -->
          <div class="feature-card">
            <h3 class="text-lg font-semibold text-grid-text mb-4">Filter Latency (100k rows)</h3>
            <div class="space-y-4">
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-grid-accent">Trigram Index (WASM)</span>
                  <span class="text-grid-bid">&lt;1ms</span>
                </div>
                <div class="h-2 bg-grid-bg rounded overflow-hidden">
                  <div class="h-full bg-grid-accent rounded" style="width: 1%"></div>
                </div>
              </div>
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-grid-muted">Linear Scan (JS)</span>
                  <span class="text-grid-muted">80ms</span>
                </div>
                <div class="h-2 bg-grid-bg rounded overflow-hidden">
                  <div class="h-full bg-grid-muted rounded" style="width: 80%"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Render Performance -->
          <div class="feature-card">
            <h3 class="text-lg font-semibold text-grid-text mb-4">Initial Render</h3>
            <div class="grid grid-cols-3 gap-4 text-center">
              <div>
                <div class="text-2xl font-bold text-grid-accent">45ms</div>
                <div class="text-xs text-grid-muted">10k rows</div>
              </div>
              <div>
                <div class="text-2xl font-bold text-grid-accent">52ms</div>
                <div class="text-xs text-grid-muted">100k rows</div>
              </div>
              <div>
                <div class="text-2xl font-bold text-grid-accent">68ms</div>
                <div class="text-xs text-grid-muted">1M rows</div>
              </div>
            </div>
          </div>

          <!-- Update Performance -->
          <div class="feature-card">
            <h3 class="text-lg font-semibold text-grid-text mb-4">Update Throughput</h3>
            <div class="grid grid-cols-2 gap-4 text-center">
              <div>
                <div class="text-2xl font-bold text-grid-bid">60 FPS</div>
                <div class="text-xs text-grid-muted">Maintained</div>
              </div>
              <div>
                <div class="text-2xl font-bold text-grid-text">10k/sec</div>
                <div class="text-xs text-grid-muted">Row updates</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Methodology -->
        <div class="feature-card">
          <h3 class="text-lg font-semibold text-grid-text mb-4">Methodology</h3>
          <div class="text-grid-muted space-y-2 text-sm">
            <p><strong class="text-grid-text">Test Environment:</strong> AMD Ryzen, Linux, Chrome 131</p>
            <p><strong class="text-grid-text">Sort Latency:</strong> Time from column header click to last pixel painted. Median of 5 runs.</p>
            <p><strong class="text-grid-text">Filter Latency:</strong> Time from keystroke to filtered view. Uses trigram index for O(1) lookups.</p>
            <p><strong class="text-grid-text">FPS Measurement:</strong> Using requestAnimationFrame timing over 10-second window.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="py-16 px-4 text-center">
      <div class="flex justify-center gap-4 flex-wrap">
        <a href="/demo" class="btn-primary">
          Try the Demo
        </a>
        <a href="/" class="btn-secondary">
          Get Started
        </a>
      </div>
    </section>
  </main>
</Base>
