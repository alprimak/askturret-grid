# Railway config for grid-landing service
# Builds both landing page and demo app

[build]
builder = "nixpacks"
# Demo build requires @askturret/grid from npm
# After first npm publish, uncomment the demo build lines:
# cd ../demo && npm install && npm run build && \
# cp -r dist ../landing/dist/demo
buildCommand = "cd landing && npm install && npm run build"
watchPatterns = ["landing/**", "demo/**", "src/**"]

[deploy]
startCommand = "cd landing && node_modules/.bin/serve dist -s -l $PORT"
healthcheckPath = "/"
healthcheckTimeout = 300
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3
