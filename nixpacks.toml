# Force Node.js 20 for Astro compatibility
[phases.setup]
nixPkgs = ["nodejs_20", "npm-10_x"]

[phases.install]
cmds = [
  "cd landing && npm install",
  "cd demo && npm install"
]

[phases.build]
cmds = [
  "cd landing && npm run build",
  "cd demo && npm run build",
  "cp -r demo/dist landing/dist/demo"
]

[start]
cmd = "cd landing && npx serve dist -s -l ${PORT:-3000}"
